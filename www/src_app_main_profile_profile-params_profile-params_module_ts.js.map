{"version":3,"file":"src_app_main_profile_profile-params_profile-params_module_ts.js","mappings":"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","sources":["./src/app/main/profile/profile-params/profile-params-routing.module.ts","./src/app/main/profile/profile-params/profile-params.module.ts","./src/app/main/profile/profile-params/profile-params.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ProfileParamsPage } from './profile-params.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfileParamsPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProfileParamsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { SharedModule } from 'src/shared/shared.module';\nimport { ProfileParamsPageRoutingModule } from './profile-params-routing.module';\nimport { ProfileParamsPage } from './profile-params.page';\n\n@NgModule({\n  imports: [SharedModule, FormsModule, ProfileParamsPageRoutingModule],\n  declarations: [ProfileParamsPage],\n})\nexport class ProfileParamsPageModule {}\n","import { HttpClient } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { LoadingController } from '@ionic/angular';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { AppConstants, ProfileConstants } from 'src/app/app.constants';\nimport { LoginService } from 'src/shared/services/login.service';\nimport { ToasterService } from 'src/shared/services/toaster.service';\nimport { PersonalShopperStateService } from 'src/shared/state/personal-shopper-state.service';\nimport { SubscriberComponent } from 'src/shared/utils/subscriber-component';\nimport { FirebaseAnalytics } from '@capacitor-community/firebase-analytics';\nimport { Router } from '@angular/router';\nimport { DataService } from 'src/shared/services/data.service';\nimport { IShopper } from 'src/shared/models/type';\nimport { WardrobeStateService } from 'src/shared/state/wardrobe-state.service';\nimport { AppStateService } from 'src/shared/state/app.state.service';\nimport { NgxSpinnerService } from 'ngx-spinner';\n\n@Component({\n  selector: 'app-profile-params',\n  templateUrl: './profile-params.page.html',\n  styleUrls: ['./profile-params.page.scss'],\n})\nexport class ProfileParamsPage extends SubscriberComponent implements OnInit {\n  swipeFiltersGenders = ProfileConstants.swipeFiltersGenders;\n  paramsGroup: FormGroup;\n  currentUser: IShopper;\n  constructor(\n    public readonly loadingController: LoadingController,\n    private readonly fb: FormBuilder,\n    private readonly dataService: DataService,\n    private readonly http: HttpClient,\n    private readonly toaster: ToasterService,\n    private readonly personalShopperState: PersonalShopperStateService,\n    private readonly appState: AppStateService,\n    private readonly loginServ: LoginService,\n    private router: Router,\n    private spinner: NgxSpinnerService\n  ) {\n    super();\n    this.paramsGroup = this.fb.group({\n      swipeGender: [null, Validators.required],\n    });\n    this.dataService.getUserData().then(user => {\n      this.currentUser = user\n      this.paramsGroup.controls[\"swipeGender\"].setValue(user.swipe_filter.gender_id, { emitEvent: false });\n    })\n  }\n\n  ngOnInit() {\n    this.addSubscription(\n      this.paramsGroup.controls['swipeGender'].valueChanges\n        .pipe(distinctUntilChanged())\n        .subscribe(newSwipeGenderID => {\n          const shopper = {\n            swipe_filter: {\n              gender_id: newSwipeGenderID,\n            },\n          };\n          this.spinner.show('appSpinner')\n          this.http\n            .patch(\n              `${AppConstants.shopperUrl}/${this.currentUser.id}`,\n              { shopper },\n              { observe: 'response' }\n            )\n            .subscribe((response: any) => {\n              this.dataService.updateKeyValue(\"user\", response.body.data);\n              this.currentUser = response.body.data;\n              this.appState.setUserInfos(response.body.data)\n              this.personalShopperState.initStore().subscribe();\n              this.spinner.hide(\"appSpinner\")\n              this.toaster.presentSuccessToast(`MESSAGE.PROFILE.EDIT_${response.status}`);\n            }),\n            error => {\n              this.spinner.hide(\"appSpinner\")\n              this.toaster.presentErrorToast('SHARED.ERROR');\n            };\n        })\n    );\n  }\n\n  onLogout() {\n    this.loginServ.signOut().then(() => {\n      this.dataService.removeItem(\"user\");\n      this.dataService.clear();\n      //TODO: change ! this is a hack\n      //this.personalShopperState.resetAvailableProducts();\n      //this.wardrobeState.resetStyles();\n      ///END hack/////\n      //this.router.navigate([\"/home\"], { replaceUrl: true })\n      location.reload()\n    })\n      .catch(error => console.log(\"There is an error Log out !\" + error))\n  }\n\n  ionViewWillEnter() {\n    FirebaseAnalytics.setScreenName({\n      screenName: \"ProfileParametersScreen\",\n      nameOverride: \"ProfileParametersScreen\",\n    });\n  }\n\n  ionViewDidEnter() {\n    this.spinner.hide('appSpinner')\n  }\n\n  async showLoadingIndictator() {\n    const loadingIndicator = await this.loadingController.create({\n      message: 'Deconnexion...',\n    });\n    return await loadingIndicator.present();\n  }\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}