{"version":3,"file":"src_app_main_wardrobe_modify-style_modify-style_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;AAAyC;AACc;AACS;AAEhE,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,yEAAoB;KAChC;CACF,CAAC;AAMK,IAAM,wBAAwB,GAA9B,MAAM,wBAAwB;CAAG;AAA3B,wBAAwB;IAJpC,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,yDAAY,CAAC;KACxB,CAAC;GACW,wBAAwB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfM;AACO;AACkB;AACnB;AACA;AACD;AACiC;AACoC;AAEhD;AACA;AACE;AACQ;AAOxE,IAAM,oBAAoB,GAA1B,MAAM,oBAAoB;IAc/B,YACmB,EAAe,EACf,KAAsB,EACtB,OAAwB,EACxB,cAA8B,EAC9B,KAAqB,EACrB,cAA8B,EAC9B,aAAmC,EAC5C,QAAkB,EACT,OAA0B;QAR1B,OAAE,GAAF,EAAE,CAAa;QACf,UAAK,GAAL,KAAK,CAAiB;QACtB,YAAO,GAAP,OAAO,CAAiB;QACxB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,UAAK,GAAL,KAAK,CAAgB;QACrB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,kBAAa,GAAb,aAAa,CAAsB;QAC5C,aAAQ,GAAR,QAAQ,CAAU;QACT,YAAO,GAAP,OAAO,CAAmB;QAnB7C,gBAAW,GAAG,EAAE,CAAC,CAAC,aAAa;QAC/B,kBAAa,GAAG,oFAAiC,CAAC;QAElD,oBAAe,GAAG,IAAI,GAAG,CAAqB;YAC5C,CAAC,QAAQ,EAAE,EAAE,CAAC;YACd,CAAC,QAAQ,EAAE,EAAE,CAAC;YACd,CAAC,QAAQ,EAAE,EAAE,CAAC;SACf,CAAC,CAAC;QACH,kBAAa,GAAG,KAAK,CAAC;IAYlB,CAAC;IAEL,gBAAgB;QACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;IACrC,CAAC;IACD,gBAAgB;QACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;IACrC,CAAC;IACD,QAAQ;QACN,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;QAC1E,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,2BAA2B,CAClE,0FAAuC,CACxC,CAAC;QACF,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACjD,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC;QACrD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;QAC1C,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;QAC1D,IAAI,CAAC,aAAa,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC;IAC3C,CAAC;IACO,QAAQ;QACd,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC;YAC7B,KAAK,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,+DAAmB,EAAE,gEAAoB,CAAC,EAAE,CAAC,CAAC,CAAC;YACjF,SAAS,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,+DAAmB,CAAC;YAC7D,IAAI,EAAE,CAAC,EAAE,CAAC;YACV,UAAU,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE,+DAAmB,CAAC;SAChE,CAAC,CAAC;IACL,CAAC;IACO,cAAc;QACpB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,IAAc,EAAE,EAAE;YACjD,MAAM,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YACrF,MAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;YAC5D,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpB,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;QACvD,CAAC,CAAC,CAAC;IACL,CAAC;IAED,eAAe;QACb,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC;IACjC,CAAC;IACD,QAAQ,CAAC,GAAW;QAClB,IAAI,GAAG,KAAK,EAAE,EAAE;YACd,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;YACrC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;SACjE;IACH,CAAC;IAED,WAAW,CAAC,KAAa;QACvB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IACpC,CAAC;IAEK,sBAAsB,CAAC,QAAgB;;YAC3C,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;gBACpC,SAAS,EAAE,+HAA0B;gBACrC,cAAc,EAAE;oBACd,eAAe,EAAE,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC;oBACnD,QAAQ;iBACT;aACF,CAAC,CAAC;YACH,KAAK,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;gBACjC,IAAI,MAAM,CAAC,IAAI,EAAE;oBACf,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iBACtE;YACH,CAAC,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAED,MAAM;QACJ,MAAM,KAAK,GAAG;YACZ,EAAE,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE;YACxB,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK;YACjC,KAAK,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;gBAC5D,OAAO,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC;YACzB,CAAC,CAAC;YACF,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,SAAS,CAAC;YACjD,IAAI,EAAE,IAAI,CAAC,WAAW;YACtB,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,UAAU,CAAC;SACpD,CAAC;QACF,oCAAoC;QACpC,wCAAwC;QACxC,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,CAAC,QAAa,EAAE,EAAE;YAC1D,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,wBAAwB,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;YACnF,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnD,IAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxD,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACvB,CAAC,CAAC;YACA,KAAK,CAAC,EAAE;gBACN,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;gBACpD,gBAAgB;gBAChB,uBAAuB;YACzB,CAAC,CAAC;QACJ;;;;;;;;;;WAUG;IACL,CAAC;IAEO,SAAS;QACf,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC;QACvB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC;IAC/B,CAAC;IAED,WAAW;QACT,OAAO,CACL,IAAI,CAAC,SAAS,CAAC,KAAK;YACpB,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,MAAM;YACzC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,MAAM,CAC1C,CAAC;IACJ,CAAC;;;YAlKM,uDAAW;YAEX,4DAAe;YAOf,iFAAe;YADf,+EAAc;YAPd,4DAAc;YAMd,+EAAc;YAGd,yFAAoB;YAZpB,sDAAQ;YAKR,2DAAiB;;AAcb,oBAAoB;IALhC,yDAAS,CAAC;QACT,QAAQ,EAAE,kBAAkB;QAC5B,8EAA4C;;KAE7C,CAAC;GACW,oBAAoB,CAkJhC;AAlJgC;;;;;;;;;;;;;;;;;;;;;;;;ACnBc;AACN;AACY;AACR;AACW;AACiB;AACT;AAMzD,IAAM,iBAAiB,GAAvB,MAAM,iBAAiB;CAAG;AAApB,iBAAiB;IAL7B,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,yDAAY,EAAE,+DAAmB,EAAE,uDAAW,EAAE,kFAAwB,EAAE,kEAAY,CAAC;QACjG,YAAY,EAAE,CAAC,yEAAoB,CAAC;QACpC,SAAS,EAAE,EAAE;KACd,CAAC;GACW,iBAAiB,CAAG;AAAH","sources":["./src/app/main/wardrobe/modify-style/modify-style-routing.module.ts","./src/app/main/wardrobe/modify-style/modify-style.component.ts","./src/app/main/wardrobe/modify-style/modify-style.module.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ModifyStyleComponent } from './modify-style.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ModifyStyleComponent,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ModifyStyleRoutingModule {}\n","import { Location } from '@angular/common';\nimport { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport { ModalController } from '@ionic/angular';\nimport { NgxSpinnerService } from 'ngx-spinner';\nimport { LocalStorageConstants, WardRobeConstants } from 'src/app/app.constants';\nimport { ArticlesCardModalComponent } from 'src/shared/components/articles-card-modal/articles-card-modal.component';\nimport { IArticle, IStyle } from 'src/shared/models/type';\nimport { StorageService } from 'src/shared/services/storage.service';\nimport { ToasterService } from 'src/shared/services/toaster.service';\nimport { WardrobeService } from 'src/shared/services/wardrobe.service';\nimport { WardrobeStateService } from 'src/shared/state/wardrobe-state.service';\n\n@Component({\n  selector: 'app-modify-style',\n  templateUrl: './modify-style.component.html',\n  styleUrls: ['./modify-style.component.scss'],\n})\nexport class ModifyStyleComponent implements OnInit {\n  styleForm: FormGroup;\n  tabBar: HTMLElement;\n  moonSegment: HTMLElement;\n  currentTags = []; //change type\n  categoriesIds = WardRobeConstants.categoriesIndex;\n  currentStyle: IStyle;\n  currentArticles = new Map<string, IArticle[]>([\n    ['FAM_01', []],\n    ['FAM_02', []],\n    ['FAM_03', []],\n  ]);\n  wear_at_night = false;\n  categoriesMap: any;\n  constructor(\n    private readonly fb: FormBuilder,\n    private readonly modal: ModalController,\n    private readonly service: WardrobeService,\n    private readonly toasterService: ToasterService,\n    private readonly route: ActivatedRoute,\n    private readonly storageService: StorageService,\n    private readonly wardrobeState: WardrobeStateService,\n    private location: Location,\n    private readonly spinner: NgxSpinnerService\n  ) { }\n\n  ionViewWillEnter() {\n    this.tabBar.style.display = 'none';\n  }\n  ionViewWillLeave() {\n    this.tabBar.style.display = 'flex';\n  }\n  ngOnInit() {\n    this.currentStyle = JSON.parse(this.route.snapshot.paramMap.get('style'));\n    this.categoriesMap = this.storageService.getJSONItemFromLocalStorage(\n      LocalStorageConstants.CATEGORIES_AS_MAP\n    );\n    this.tabBar = document.getElementById('tab-bar');\n    this.initForm();\n    this.wear_at_night = this.currentStyle.wear_at_night;\n    this.currentTags = this.currentStyle.tags;\n    this.initArticleMap();\n  }\n\n  onSelect() {\n    this.moonSegment = document.getElementById('moonSegment');\n    this.wear_at_night = !this.wear_at_night;\n  }\n  private initForm() {\n    this.styleForm = this.fb.group({\n      title: [this.currentStyle.title, [Validators.required, Validators.maxLength(32)]],\n      season_id: [this.currentStyle.season_id, Validators.required],\n      tags: [''],\n      weather_id: [this.currentStyle.weather_id, Validators.required],\n    });\n  }\n  private initArticleMap() {\n    this.currentStyle.items.forEach((item: IArticle) => {\n      const ancestorCategory = this.categoriesMap[item.category_id].ancestry.split('.')[0];\n      const articles = this.currentArticles.get(ancestorCategory);\n      articles.push(item);\n      this.currentArticles.set(ancestorCategory, articles);\n    });\n  }\n\n  ionViewDidEnter() {\n    this.spinner.hide('appSpinner')\n  }\n  onAddTag(tag: string) {\n    if (tag !== '') {\n      this.currentTags.push({ name: tag });\n      this.styleForm.controls['tags'].reset('', { emitEvent: false });\n    }\n  }\n\n  onRemoveTag(index: number) {\n    this.currentTags.splice(index, 1);\n  }\n\n  async onOpenArticleCardModal(category: string) {\n    const modal = await this.modal.create({\n      component: ArticlesCardModalComponent,\n      componentProps: {\n        currentArticles: this.currentArticles.get(category),\n        category,\n      },\n    });\n    modal.onDidDismiss().then(result => {\n      if (result.data) {\n        this.currentArticles.set(result.data.category, result.data.articles);\n      }\n    });\n    await modal.present();\n  }\n\n  onSave() {\n    const style = {\n      id: this.currentStyle.id,\n      title: this.styleForm.value.title,\n      items: [].concat(...this.currentArticles.values()).map(item => {\n        return { id: item.id };\n      }),\n      season_id: Number(this.styleForm.value.season_id),\n      tags: this.currentTags,\n      wear_at_night: this.wear_at_night,\n      weather_id: Number(this.styleForm.value.weather_id),\n    };\n    //const form = this.styleForm.value;\n    //style.id = this.styleForm.value.title;\n    this.service.updateStyle(style).subscribe((response: any) => {\n      this.toasterService.presentSuccessToast(`MESSAGE.PROFILE.EDIT_${response.status}`);\n      this.wardrobeState.updateStyle(response.body.data);\n      this.wardrobeState.hasStyleModified(response.body.data);\n      this.location.back();\n    }),\n      error => {\n        this.toasterService.presentErrorToast(error.status);\n        //Error callback\n        //this.loading = false;\n      };\n    /*return this.service.postNewStyle(style).subscribe((response: any) => {\n      this.toasterService.presentSuccessToast(`MESSAGE.WARDROBE_ITEMS.${response.status}`);\n      this.service.addNewStyle(response.body.data);\n      this.location.back();\n\n    },\n\n      (error) => {\n        this.toasterService.presentErrorToast(error.status);\n      }\n    )*/\n  }\n\n  private resetForm() {\n    this.styleForm.reset();\n    this.currentTags = [];\n    this.currentArticles.clear();\n  }\n\n  isFormValid() {\n    return (\n      this.styleForm.valid &&\n      this.currentArticles.get('FAM_01').length &&\n      this.currentArticles.get('FAM_02').length\n    );\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { SharedModule } from 'src/shared/shared.module';\nimport { ModifyStyleRoutingModule } from './modify-style-routing.module';\nimport { ModifyStyleComponent } from './modify-style.component';\n@NgModule({\n  imports: [CommonModule, ReactiveFormsModule, IonicModule, ModifyStyleRoutingModule, SharedModule],\n  declarations: [ModifyStyleComponent],\n  providers: [],\n})\nexport class ModifyStyleModule {}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}